# Cost-Optimized Backup Configuration
# Target: $150-300/month for backup infrastructure
# Remaining: $700-850/month for AI services

# ===== BACKUP CONFIGURATION =====

# Enable backups
BACKUP_ENABLED=true

# Single region setup (choose different from production)
# If production is us-east-1, use us-west-2
AWS_BACKUP_REGION=us-west-2
BACKUP_S3_BUCKET=huntaze-backups-production

# Use standard S3 encryption (free) instead of KMS ($)
# Still secure, just not with custom keys
BACKUP_ENCRYPTION_TYPE=AES256
# Local encryption key for additional security
BACKUP_ENCRYPTION_KEY=generate-with-openssl-rand-hex-32

# Retention settings (optimized for cost)
BACKUP_RETENTION_DAILY=7        # Keep daily backups for 1 week
BACKUP_RETENTION_WEEKLY=4       # Keep weekly backups for 1 month  
BACKUP_RETENTION_MONTHLY=6      # Keep monthly backups for 6 months
BACKUP_DELETE_AFTER_DAYS=180    # Delete all after 6 months

# Lifecycle transitions (days)
BACKUP_TO_IA_DAYS=1            # Move to Infrequent Access after 1 day
BACKUP_TO_GLACIER_IR_DAYS=7    # Move to Glacier IR after 1 week
BACKUP_TO_GLACIER_DAYS=30      # Move to Glacier after 1 month
BACKUP_TO_DEEP_ARCHIVE_DAYS=90 # Move to Deep Archive after 3 months

# Compression settings
BACKUP_COMPRESSION_LEVEL=9      # Maximum compression (slower but smaller)
BACKUP_COMPRESSION_TYPE=gzip    # Good balance of speed and ratio

# Incremental backups (after initial full backup)
BACKUP_INCREMENTAL_ENABLED=true
BACKUP_FULL_BACKUP_DAY=1       # Full backup on 1st of month

# Weekly replication (not real-time)
BACKUP_REPLICATION_ENABLED=true
BACKUP_REPLICATION_SCHEDULE="0 3 * * 0"  # Sunday 3 AM
BACKUP_REPLICATION_REGION=eu-west-1
BACKUP_REPLICATION_BUCKET=huntaze-backups-replica

# Only replicate critical data
BACKUP_REPLICATION_FILTER=database,configuration
BACKUP_REPLICATION_MAX_AGE_DAYS=7

# ===== AI BUDGET ALLOCATION =====

# Azure OpenAI (Primary AI - $500-600/month)
AZURE_OPENAI_ENDPOINT=https://your-instance.openai.azure.com/
AZURE_OPENAI_API_KEY=your-api-key
AZURE_OPENAI_DEPLOYMENT_NAME=gpt-4
AZURE_OPENAI_MAX_MONTHLY_BUDGET=600

# Claude API (Secondary AI - $200-250/month)
ANTHROPIC_API_KEY=your-claude-api-key
ANTHROPIC_MAX_MONTHLY_BUDGET=250

# ===== COST MONITORING =====

# Budget alerts
BUDGET_ALERT_EMAIL=charles@huntaze.com
BUDGET_WARNING_THRESHOLD=80    # Alert at 80% of budget
BUDGET_CRITICAL_THRESHOLD=95   # Critical alert at 95%

# Monthly limits
BUDGET_TOTAL_MONTHLY=1000
BUDGET_BACKUP_MONTHLY=200      # Target: $150, Max: $200
BUDGET_AI_MONTHLY=800          # Remaining budget for AI

# ===== OPTIMIZATION FLAGS =====

# Deduplication
BACKUP_DEDUP_ENABLED=true      # Skip duplicate files

# Exclude patterns (save space)
BACKUP_EXCLUDE_PATTERNS=*.log,*.tmp,node_modules/,cache/,.git/

# Test/Dev backups
BACKUP_TEST_RETENTION_DAYS=3   # Delete test backups after 3 days
BACKUP_DEV_ENABLED=false       # Disable dev backups entirely

# ===== MONITORING =====

# Cost tracking webhook
COST_MONITORING_WEBHOOK=https://your-monitoring.com/webhook
COST_CHECK_FREQUENCY=daily

# Backup health checks
BACKUP_HEALTH_CHECK_ENABLED=true
BACKUP_HEALTH_CHECK_SCHEDULE="0 6 * * *"  # Daily at 6 AM