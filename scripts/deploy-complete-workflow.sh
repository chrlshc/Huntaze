#!/bin/bash

# Workflow Complet de D√©ploiement
# Guide interactif pour d√©ployer les optimisations de performance

set -e

# Couleurs
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
MAGENTA='\033[0;35m'
CYAN='\033[0;36m'
NC='\033[0m'

clear

echo -e "${CYAN}"
cat << "EOF"
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                                                              ‚ïë
‚ïë   üöÄ WORKFLOW COMPLET DE D√âPLOIEMENT                        ‚ïë
‚ïë   Optimisations de Performance Dashboard                    ‚ïë
‚ïë                                                              ‚ïë
‚ïë   ‚úÖ 164/164 tests passent (100%)                           ‚ïë
‚ïë   ‚úÖ 23 propri√©t√©s valid√©es                                 ‚ïë
‚ïë   ‚úÖ 16,400+ cas de test                                    ‚ïë
‚ïë                                                              ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
EOF
echo -e "${NC}"
echo ""

# Menu principal
show_menu() {
    echo -e "${BLUE}Que voulez-vous faire?${NC}"
    echo ""
    echo "  1) üìã Voir le statut du projet"
    echo "  2) üß™ Ex√©cuter tous les tests"
    echo "  3) üîß D√©ployer sur STAGING"
    echo "  4) ‚úÖ V√©rifier STAGING"
    echo "  5) üöÄ D√©ployer en PRODUCTION"
    echo "  6) ‚úÖ V√©rifier PRODUCTION"
    echo "  7) üìä Voir les m√©triques de performance"
    echo "  8) üìñ Ouvrir la documentation"
    echo "  9) üÜò Guide de d√©pannage"
    echo "  0) ‚ùå Quitter"
    echo ""
    echo -n "Votre choix: "
}

# Fonction pour afficher le statut
show_status() {
    clear
    echo -e "${GREEN}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${GREEN}‚ïë  üìä STATUT DU PROJET                                        ‚ïë${NC}"
    echo -e "${GREEN}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo -e "${BLUE}Tests:${NC}"
    echo "  ‚úÖ Tests unitaires: 164/164 (100%)"
    echo "  ‚úÖ Tests de propri√©t√©s: 18/18 fichiers"
    echo "  ‚úÖ Propri√©t√©s valid√©es: 23/23"
    echo "  ‚úÖ Cas de test: 16,400+"
    echo ""
    
    echo -e "${BLUE}Optimisations:${NC}"
    echo "  ‚úÖ Diagnostic et baseline"
    echo "  ‚úÖ Optimisations de rendu"
    echo "  ‚úÖ Optimisations SWR"
    echo "  ‚úÖ Strat√©gies de cache"
    echo "  ‚úÖ Monitoring production-safe"
    echo "  ‚úÖ Int√©gration AWS"
    echo "  ‚úÖ Optimisations database"
    echo "  ‚úÖ Mesure d'impact"
    echo ""
    
    echo -e "${BLUE}Performance attendue:${NC}"
    echo "  ‚ö° Temps de chargement: -60-70%"
    echo "  ‚ö° Requ√™tes database: -90%"
    echo "  ‚ö° Requ√™tes N+1: -100%"
    echo "  ‚ö° Cache hit rate: >80%"
    echo ""
    
    echo -e "${GREEN}‚úÖ PR√äT POUR PRODUCTION!${NC}"
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour ex√©cuter les tests
run_tests() {
    clear
    echo -e "${BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${BLUE}‚ïë  üß™ EX√âCUTION DES TESTS                                     ‚ïë${NC}"
    echo -e "${BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo -e "${YELLOW}Tests unitaires...${NC}"
    if npm run test:unit:optimized; then
        echo -e "${GREEN}‚úÖ Tests unitaires pass√©s${NC}"
    else
        echo -e "${RED}‚ùå Tests unitaires √©chou√©s${NC}"
        read -p "Appuyez sur Entr√©e pour continuer..."
        return 1
    fi
    
    echo ""
    echo -e "${YELLOW}Tests de performance...${NC}"
    if npm run test:performance; then
        echo -e "${GREEN}‚úÖ Tests de performance pass√©s${NC}"
    else
        echo -e "${YELLOW}‚ö†Ô∏è  Certains tests de performance ont √©chou√©${NC}"
    fi
    
    echo ""
    echo -e "${GREEN}‚úÖ Tous les tests sont termin√©s!${NC}"
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour d√©ployer sur staging
deploy_staging() {
    clear
    echo -e "${BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${BLUE}‚ïë  üîß D√âPLOIEMENT STAGING                                     ‚ïë${NC}"
    echo -e "${BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo "Ce script va:"
    echo "  1. V√©rifier l'environnement"
    echo "  2. Ex√©cuter les tests"
    echo "  3. Cr√©er un build"
    echo "  4. Pousser vers staging"
    echo ""
    
    read -p "Continuer? (y/N) " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        return
    fi
    
    ./scripts/deploy-to-staging.sh
    
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour v√©rifier staging
verify_staging() {
    clear
    echo -e "${BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${BLUE}‚ïë  ‚úÖ V√âRIFICATION STAGING                                    ‚ïë${NC}"
    echo -e "${BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    read -p "URL de staging (d√©faut: https://staging.huntaze.com): " STAGING_URL
    STAGING_URL=${STAGING_URL:-https://staging.huntaze.com}
    
    echo ""
    echo "V√©rification de $STAGING_URL..."
    echo ""
    
    ./scripts/verify-deployment.sh "$STAGING_URL"
    
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour d√©ployer en production
deploy_production() {
    clear
    echo -e "${MAGENTA}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${MAGENTA}‚ïë  üöÄ D√âPLOIEMENT PRODUCTION                                  ‚ïë${NC}"
    echo -e "${MAGENTA}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo -e "${RED}‚ö†Ô∏è  ATTENTION: Vous √™tes sur le point de d√©ployer en PRODUCTION${NC}"
    echo ""
    echo "Assurez-vous que:"
    echo "  ‚úì Staging a √©t√© d√©ploy√© et test√©"
    echo "  ‚úì Tous les tests manuels sont pass√©s"
    echo "  ‚úì Les m√©triques de staging sont bonnes"
    echo "  ‚úì Un backup de la DB a √©t√© effectu√©"
    echo ""
    
    read -p "Continuer? (y/N) " -n 1 -r
    echo
    if [[ ! $REPLY =~ ^[Yy]$ ]]; then
        return
    fi
    
    ./scripts/deploy-to-production.sh
    
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour v√©rifier production
verify_production() {
    clear
    echo -e "${GREEN}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${GREEN}‚ïë  ‚úÖ V√âRIFICATION PRODUCTION                                 ‚ïë${NC}"
    echo -e "${GREEN}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    read -p "URL de production (d√©faut: https://app.huntaze.com): " PROD_URL
    PROD_URL=${PROD_URL:-https://app.huntaze.com}
    
    echo ""
    echo "V√©rification de $PROD_URL..."
    echo ""
    
    ./scripts/verify-deployment.sh "$PROD_URL"
    
    echo ""
    echo -e "${YELLOW}Surveillance recommand√©e pendant 2 heures${NC}"
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour afficher les m√©triques
show_metrics() {
    clear
    echo -e "${CYAN}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${CYAN}‚ïë  üìä M√âTRIQUES DE PERFORMANCE                                ‚ïë${NC}"
    echo -e "${CYAN}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo "Que voulez-vous faire?"
    echo ""
    echo "  1) Surveiller en temps r√©el"
    echo "  2) G√©n√©rer un rapport"
    echo "  3) V√©rifier l'infrastructure AWS"
    echo "  4) Retour au menu"
    echo ""
    read -p "Votre choix: " choice
    
    case $choice in
        1)
            npm run perf:monitor
            ;;
        2)
            npm run perf:report
            ;;
        3)
            npm run aws:verify
            ;;
        *)
            return
            ;;
    esac
    
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Fonction pour afficher la documentation
show_docs() {
    clear
    echo -e "${BLUE}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${BLUE}‚ïë  üìñ DOCUMENTATION                                           ‚ïë${NC}"
    echo -e "${BLUE}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo "Documentation disponible:"
    echo ""
    echo "  1) Guide rapide de d√©ploiement (QUICK-DEPLOY.md)"
    echo "  2) Guide complet de d√©ploiement (DEPLOYMENT-GUIDE.md)"
    echo "  3) Statut du projet (PR√äT-POUR-PRODUCTION.md)"
    echo "  4) Rapport des tests (TEST-FIXES-COMPLETE.md)"
    echo "  5) Retour au menu"
    echo ""
    read -p "Votre choix: " choice
    
    case $choice in
        1)
            cat .kiro/specs/dashboard-performance-real-fix/QUICK-DEPLOY.md | less
            ;;
        2)
            cat .kiro/specs/dashboard-performance-real-fix/DEPLOYMENT-GUIDE.md | less
            ;;
        3)
            cat .kiro/specs/dashboard-performance-real-fix/PR√äT-POUR-PRODUCTION.md | less
            ;;
        4)
            cat .kiro/specs/dashboard-performance-real-fix/TEST-FIXES-COMPLETE.md | less
            ;;
        *)
            return
            ;;
    esac
}

# Fonction pour le guide de d√©pannage
show_troubleshooting() {
    clear
    echo -e "${YELLOW}‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó${NC}"
    echo -e "${YELLOW}‚ïë  üÜò GUIDE DE D√âPANNAGE                                      ‚ïë${NC}"
    echo -e "${YELLOW}‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù${NC}"
    echo ""
    
    echo "Probl√®mes courants:"
    echo ""
    echo "1. Build √©choue sur Amplify"
    echo "   ‚Üí V√©rifiez les logs dans Amplify Console"
    echo "   ‚Üí V√©rifiez les variables d'environnement"
    echo ""
    echo "2. Tests √©chouent"
    echo "   ‚Üí Ex√©cutez: npm run test:unit:optimized"
    echo "   ‚Üí V√©rifiez DATABASE_URL et REDIS_URL"
    echo ""
    echo "3. Performance d√©grad√©e"
    echo "   ‚Üí Ex√©cutez: npm run diagnostic:baseline"
    echo "   ‚Üí V√©rifiez CloudWatch metrics"
    echo ""
    echo "4. Rollback n√©cessaire"
    echo "   ‚Üí Amplify Console > Redeploy version pr√©c√©dente"
    echo "   ‚Üí Ou: git revert HEAD && git push"
    echo ""
    echo "Logs et diagnostics:"
    echo "  ‚Ä¢ AWS Amplify: https://console.aws.amazon.com/amplify/"
    echo "  ‚Ä¢ CloudWatch: https://console.aws.amazon.com/cloudwatch/"
    echo ""
    read -p "Appuyez sur Entr√©e pour continuer..."
}

# Boucle principale
while true; do
    clear
    echo -e "${CYAN}"
    cat << "EOF"
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë   üöÄ Workflow de D√©ploiement - Dashboard Performance        ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
EOF
    echo -e "${NC}"
    echo ""
    
    show_menu
    read choice
    
    case $choice in
        1) show_status ;;
        2) run_tests ;;
        3) deploy_staging ;;
        4) verify_staging ;;
        5) deploy_production ;;
        6) verify_production ;;
        7) show_metrics ;;
        8) show_docs ;;
        9) show_troubleshooting ;;
        0) 
            echo ""
            echo -e "${GREEN}Au revoir! üëã${NC}"
            echo ""
            exit 0
            ;;
        *)
            echo -e "${RED}Choix invalide${NC}"
            sleep 1
            ;;
    esac
done
