# ðŸ—ï¸ Architecture Huntaze - Diagrammes Visuels

## ðŸ“Š Vue d'Ensemble ComplÃ¨te

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         UTILISATEURS                                 â”‚
â”‚  CrÃ©ateurs OnlyFans â€¢ Fans â€¢ Administrateurs                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    CLOUDFRONT CDN (Global)                           â”‚
â”‚  â€¢ Cache statique (images, CSS, JS)                                 â”‚
â”‚  â€¢ SSL/TLS termination                                               â”‚
â”‚  â€¢ DDoS protection                                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NEXT.JS APPLICATION (Vercel/AWS Amplify)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚   Frontend   â”‚  â”‚  API Routes  â”‚  â”‚ Edge Functionsâ”‚             â”‚
â”‚  â”‚  â€¢ React 18  â”‚  â”‚  â€¢ REST API  â”‚  â”‚  â€¢ Middleware â”‚             â”‚
â”‚  â”‚  â€¢ SSR/SSG   â”‚  â”‚  â€¢ GraphQL   â”‚  â”‚  â€¢ Auth       â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                    â”‚                    â”‚
        â–¼                    â–¼                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AZURE OPENAI â”‚    â”‚  POSTGRESQL  â”‚    â”‚    STRIPE    â”‚
â”‚              â”‚    â”‚  (Supabase)  â”‚    â”‚              â”‚
â”‚ â€¢ GPT-4o     â”‚    â”‚              â”‚    â”‚ â€¢ Payments   â”‚
â”‚ â€¢ GPT-4o-miniâ”‚    â”‚ â€¢ Users      â”‚    â”‚ â€¢ Subs       â”‚
â”‚ â€¢ Routing    â”‚    â”‚ â€¢ Content    â”‚    â”‚ â€¢ Webhooks   â”‚
â”‚ â€¢ Caching    â”‚    â”‚ â€¢ Analytics  â”‚    â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚                    â”‚                    â”‚
        â”‚                    â–¼                    â”‚
        â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
        â”‚           â”‚   AWS S3     â”‚             â”‚
        â”‚           â”‚              â”‚             â”‚
        â”‚           â”‚ â€¢ Media      â”‚             â”‚
        â”‚           â”‚ â€¢ Backups    â”‚             â”‚
        â”‚           â”‚ â€¢ Artifacts  â”‚             â”‚
        â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
        â”‚                                        â”‚
        â–¼                                        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AZURE AI     â”‚                        â”‚  MONITORING  â”‚
â”‚ TEAM         â”‚                        â”‚              â”‚
â”‚              â”‚                        â”‚ â€¢ Sentry     â”‚
â”‚ â€¢ Multi-     â”‚                        â”‚ â€¢ DataDog    â”‚
â”‚   Agents     â”‚                        â”‚ â€¢ CloudWatch â”‚
â”‚ â€¢ Workflows  â”‚                        â”‚ â€¢ Analytics  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”„ Flux de DonnÃ©es

### 1. RequÃªte Utilisateur Standard

```
User Request
    â”‚
    â–¼
CloudFront CDN
    â”‚
    â”œâ”€â†’ Cache Hit? â†’ Return Cached Response
    â”‚
    â–¼ Cache Miss
Next.js App
    â”‚
    â”œâ”€â†’ Static Page? â†’ SSG â†’ Return HTML
    â”‚
    â”œâ”€â†’ Dynamic Page? â†’ SSR â†’ Fetch Data â†’ Render â†’ Return HTML
    â”‚
    â””â”€â†’ API Call? â†’ API Route
                        â”‚
                        â”œâ”€â†’ Database Query â†’ PostgreSQL
                        â”‚
                        â”œâ”€â†’ AI Request â†’ Azure OpenAI â†’ AI Router
                        â”‚                                    â”‚
                        â”‚                                    â”œâ”€â†’ 90% â†’ GPT-4o-mini
                        â”‚                                    â””â”€â†’ 10% â†’ GPT-4o
                        â”‚
                        â””â”€â†’ Payment â†’ Stripe API
```

### 2. GÃ©nÃ©ration de Contenu AI

```
User: "CrÃ©er un post Instagram"
    â”‚
    â–¼
API Route: /api/content/generate
    â”‚
    â”œâ”€â†’ Validate User (Auth)
    â”‚
    â”œâ”€â†’ Check Subscription (Stripe)
    â”‚
    â”œâ”€â†’ AI Router
    â”‚       â”‚
    â”‚       â”œâ”€â†’ Task Type: marketing_template
    â”‚       â”œâ”€â†’ Complexity: 3/10
    â”‚       â”œâ”€â†’ Critical: false
    â”‚       â””â”€â†’ Decision: GPT-4o-mini
    â”‚
    â”œâ”€â†’ Build Cached Prompt
    â”‚       â”‚
    â”‚       â”œâ”€â†’ System (cached): "Tu es l'assistant Huntaze..."
    â”‚       â””â”€â†’ User (dynamic): "CrÃ©er post sur {topic}"
    â”‚
    â”œâ”€â†’ Azure OpenAI API
    â”‚       â”‚
    â”‚       â””â”€â†’ GPT-4o-mini Response
    â”‚
    â”œâ”€â†’ Save to Database
    â”‚       â”‚
    â”‚       â””â”€â†’ PostgreSQL: content table
    â”‚
    â”œâ”€â†’ Track Analytics
    â”‚       â”‚
    â”‚       â””â”€â†’ PostgreSQL: analytics table
    â”‚
    â””â”€â†’ Return Response
            â”‚
            â””â”€â†’ User: Generated Content
```

### 3. Paiement Stripe

```
User: "Subscribe to Pro"
    â”‚
    â–¼
Frontend: Stripe Checkout
    â”‚
    â”œâ”€â†’ Create Checkout Session
    â”‚       â”‚
    â”‚       â””â”€â†’ API: /api/stripe/create-checkout
    â”‚               â”‚
    â”‚               â””â”€â†’ Stripe API: Create Session
    â”‚
    â”œâ”€â†’ Redirect to Stripe
    â”‚
    â”œâ”€â†’ User Completes Payment
    â”‚
    â””â”€â†’ Stripe Webhook
            â”‚
            â–¼
API: /api/webhooks/stripe
    â”‚
    â”œâ”€â†’ Verify Signature
    â”‚
    â”œâ”€â†’ Handle Event
    â”‚       â”‚
    â”‚       â”œâ”€â†’ subscription.created
    â”‚       â”‚       â””â”€â†’ Update Database
    â”‚       â”‚
    â”‚       â”œâ”€â†’ invoice.payment_succeeded
    â”‚       â”‚       â””â”€â†’ Activate Subscription
    â”‚       â”‚
    â”‚       â””â”€â†’ subscription.deleted
    â”‚               â””â”€â†’ Deactivate Subscription
    â”‚
    â””â”€â†’ Return 200 OK
```

## ðŸ” SÃ©curitÃ© et Authentification

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    User Login                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              NextAuth.js Middleware                      â”‚
â”‚  â€¢ Email/Password                                        â”‚
â”‚  â€¢ OAuth (Google, GitHub)                                â”‚
â”‚  â€¢ Magic Links                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â†’ Create Session
                     â”‚       â”‚
                     â”‚       â””â”€â†’ JWT Token (httpOnly cookie)
                     â”‚
                     â”œâ”€â†’ Store in Database
                     â”‚       â”‚
                     â”‚       â””â”€â†’ PostgreSQL: sessions table
                     â”‚
                     â””â”€â†’ Return to User
                             â”‚
                             â””â”€â†’ Authenticated

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Protected API Route                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Auth Middleware                             â”‚
â”‚  1. Extract JWT from cookie                              â”‚
â”‚  2. Verify signature                                     â”‚
â”‚  3. Check expiration                                     â”‚
â”‚  4. Load user from database                              â”‚
â”‚  5. Attach to request                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â†’ Valid? â†’ Continue to Handler
                     â”‚
                     â””â”€â†’ Invalid? â†’ Return 401 Unauthorized
```

## ðŸ§ª CI/CD Pipeline

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Developer Push Code                         â”‚
â”‚              git push origin main                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GitHub / CodeCommit                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â†’ Trigger GitHub Actions
                     â”‚       â”‚
                     â”‚       â”œâ”€â†’ Checkout Code
                     â”‚       â”œâ”€â†’ Install Dependencies
                     â”‚       â”œâ”€â†’ Type Check
                     â”‚       â”œâ”€â†’ Lint
                     â”‚       â”œâ”€â†’ Run Tests
                     â”‚       â””â”€â†’ Build
                     â”‚
                     â””â”€â†’ Trigger AWS CodeBuild
                             â”‚
                             â”œâ”€â†’ Install Phase
                             â”‚       â””â”€â†’ Node.js 20 + npm ci
                             â”‚
                             â”œâ”€â†’ Pre-Build Phase
                             â”‚       â”œâ”€â†’ Fetch Secrets
                             â”‚       â”œâ”€â†’ Start PostgreSQL (Docker)
                             â”‚       â”œâ”€â†’ Start Stripe Mock (Docker)
                             â”‚       â””â”€â†’ Run Migrations
                             â”‚
                             â”œâ”€â†’ Build Phase
                             â”‚       â”œâ”€â†’ TypeScript Check
                             â”‚       â”œâ”€â†’ Run Tests
                             â”‚       â””â”€â†’ Generate Coverage
                             â”‚
                             â””â”€â†’ Post-Build Phase
                                     â”œâ”€â†’ Cleanup Containers
                                     â”œâ”€â†’ Upload Artifacts to S3
                                     â””â”€â†’ Send Notifications
                                             â”‚
                                             â”œâ”€â†’ Success â†’ Deploy
                                             â”‚       â”‚
                                             â”‚       â””â”€â†’ Vercel/AWS Amplify
                                             â”‚
                                             â””â”€â†’ Failure â†’ Alert Team
                                                     â”‚
                                                     â”œâ”€â†’ Slack
                                                     â”œâ”€â†’ Email
                                                     â””â”€â†’ PagerDuty
```

## ðŸ’¾ Architecture Base de DonnÃ©es

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL                            â”‚
â”‚                    (Supabase)                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  users   â”‚  â”‚ content  â”‚  â”‚analytics â”‚  â”‚  subs    â”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ â€¢ id     â”‚  â”‚ â€¢ id     â”‚  â”‚ â€¢ id     â”‚  â”‚ â€¢ id     â”‚
â”‚ â€¢ email  â”‚  â”‚ â€¢ user_idâ”‚  â”‚ â€¢ user_idâ”‚  â”‚ â€¢ user_idâ”‚
â”‚ â€¢ name   â”‚  â”‚ â€¢ title  â”‚  â”‚ â€¢ event  â”‚  â”‚ â€¢ stripe â”‚
â”‚ â€¢ tier   â”‚  â”‚ â€¢ body   â”‚  â”‚ â€¢ data   â”‚  â”‚ â€¢ status â”‚
â”‚ â€¢ createdâ”‚  â”‚ â€¢ type   â”‚  â”‚ â€¢ createdâ”‚  â”‚ â€¢ plan   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚                            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚   Indexes    â”‚
           â”‚              â”‚
           â”‚ â€¢ user_id    â”‚
           â”‚ â€¢ email      â”‚
           â”‚ â€¢ created_at â”‚
           â”‚ â€¢ status     â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ¤– SystÃ¨me de Routage AI

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Request                                  â”‚
â”‚  taskType: 'chatbot'                                     â”‚
â”‚  prompt: 'Comment augmenter engagement?'                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              AI Router                                   â”‚
â”‚  1. Analyze Request                                      â”‚
â”‚     â€¢ Task Type: chatbot                                 â”‚
â”‚     â€¢ Complexity: 3/10                                   â”‚
â”‚     â€¢ Critical: false                                    â”‚
â”‚     â€¢ Output Length: short                               â”‚
â”‚                                                          â”‚
â”‚  2. Decision Matrix                                      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚     â”‚ Critical? â†’ YES â†’ GPT-4o         â”‚               â”‚
â”‚     â”‚           â†’ NO  â†’ Check Complexityâ”‚               â”‚
â”‚     â”‚                   â”‚                â”‚               â”‚
â”‚     â”‚                   â”œâ”€â†’ >7 â†’ GPT-4o â”‚               â”‚
â”‚     â”‚                   â””â”€â†’ <7 â†’ mini   â”‚               â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                          â”‚
â”‚  3. Selected Model: GPT-4o-mini                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Prompt Builder                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ STATIC (Cached 90% savings)                â”‚        â”‚
â”‚  â”‚ "Tu es l'assistant Huntaze..."             â”‚        â”‚
â”‚  â”‚ [1000 tokens]                              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ DYNAMIC (Not cached)                       â”‚        â”‚
â”‚  â”‚ "User: {name}, Tier: {tier}"               â”‚        â”‚
â”‚  â”‚ "Query: {prompt}"                          â”‚        â”‚
â”‚  â”‚ [100 tokens]                               â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Azure OpenAI API                            â”‚
â”‚  Model: gpt-4o-mini                                      â”‚
â”‚  Tokens: 1100 (900 cached)                               â”‚
â”‚  Cost: $0.002                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Response                                    â”‚
â”‚  â€¢ Content: AI generated text                            â”‚
â”‚  â€¢ Model: gpt-4o-mini                                    â”‚
â”‚  â€¢ Tokens: {input: 1100, output: 150, cached: 900}      â”‚
â”‚  â€¢ Latency: 234ms                                        â”‚
â”‚  â€¢ Cost: $0.002                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ“Š Monitoring et ObservabilitÃ©

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Metrics                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚            â”‚            â”‚            â”‚
        â–¼            â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Sentry  â”‚  â”‚ DataDog  â”‚  â”‚CloudWatchâ”‚  â”‚ Analyticsâ”‚
â”‚          â”‚  â”‚          â”‚  â”‚          â”‚  â”‚          â”‚
â”‚ â€¢ Errors â”‚  â”‚ â€¢ APM    â”‚  â”‚ â€¢ Logs   â”‚  â”‚ â€¢ Events â”‚
â”‚ â€¢ Traces â”‚  â”‚ â€¢ Metricsâ”‚  â”‚ â€¢ Alarms â”‚  â”‚ â€¢ Users  â”‚
â”‚ â€¢ Issues â”‚  â”‚ â€¢ Traces â”‚  â”‚ â€¢ Metricsâ”‚  â”‚ â€¢ Revenueâ”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚             â”‚             â”‚             â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚  Dashboard   â”‚
           â”‚              â”‚
           â”‚ â€¢ Uptime     â”‚
           â”‚ â€¢ Latency    â”‚
           â”‚ â€¢ Errors     â”‚
           â”‚ â€¢ AI Costs   â”‚
           â”‚ â€¢ Revenue    â”‚
           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

**ðŸŽ¯ Architecture optimisÃ©e pour:**
- âœ… Performance (< 200ms p95)
- âœ… ScalabilitÃ© (millions d'utilisateurs)
- âœ… CoÃ»ts (98% Ã©conomies AI)
- âœ… SÃ©curitÃ© (GDPR compliant)
- âœ… DisponibilitÃ© (99.9% uptime)
